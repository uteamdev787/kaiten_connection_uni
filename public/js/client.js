Addon.initialize({
  // 1. –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
  'card_buttons': async (context) => {
    
    // –ò–°–ü–û–õ–¨–ó–£–ï–ú –û–ü–¶–ò–û–ù–ê–õ–¨–ù–£–Æ –¶–ï–ü–û–ß–ö–£ ('?.')
    // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–æ–¥ –Ω–µ —É–ø–∞–¥–µ—Ç —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ context –∏–ª–∏ context.space –±—É–¥—É—Ç undefined.
    // –ï—Å–ª–∏ id –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –Ω–µ —Ä–∞–≤–µ–Ω 517319, –º—ã –ø—Ä–æ—Å—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º.
    if (context?.space?.id !== 517319) {
      return []; // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
    }

    // –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É
    return [{
      text: 'üîó –°–≤—è–∑–∞—Ç—å —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º',
      callback: async (buttonContext) => {
        return buttonContext.openPopup({
          type: 'iframe',
          title: '–°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º –ø–æ –ò–ù–ù',
          url: './public/views/link-contract.html',
          height: 200,
          width: 500
        });
      }
    }];
  },

  // 2. –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–æ–∫ (–±–µ–π–¥–∂) –Ω–∞ —Ñ–∞—Å–∞–¥ –∫–∞—Ä—Ç–æ—á–∫–∏
  'card_facade_badges': async (context) => {
    try {
      // –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ try...catch –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –∏ –∑–¥–µ—Å—å –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –ø–æ—Ö–æ–∂–∞—è –ø—Ä–æ–±–ª–µ–º–∞
      const card = await context.getCard();
      
      if (card && card.parent_id) {
        return {
          text: '‚úì –°–≤—è–∑–∞–Ω —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º',
          color: 'green'
        };
      }
    } catch (error) {
      // –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø—Ä–æ—Å—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –ª–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
      console.error('Error in card_facade_badges:', error);
    }
    
    return null; // –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è parent_id –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
  }
});
