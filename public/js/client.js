Addon.initialize({
  // 1. –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
  'card_buttons': async (context) => {
    
    // ID –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –±–µ—Ä–µ–º –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é.
    // –≠—Ç–æ –Ω–∞–¥–µ–∂–Ω–µ–µ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ª–∏—à–Ω–µ–≥–æ API-–∑–∞–ø—Ä–æ—Å–∞.
    if (context.space.id !== 517319) {
      return []; // –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å—á–µ—Ç–æ–≤, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
    }

    // –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Å—á–µ—Ç–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É
    return [{
      text: 'üîó –°–≤—è–∑–∞—Ç—å —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º',
      callback: async (buttonContext) => {
        // –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ (popup)
        return buttonContext.openPopup({
          type: 'iframe',
          title: '–°–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º –ø–æ –ò–ù–ù',
          url: './public/views/link-contract.html', // URL –Ω–∞—à–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
          height: 200, // –í—ã—Å–æ—Ç–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ-–ø–æ–¥—Å—Ç—Ä–æ–µ–Ω–∞ —Å–∫—Ä–∏–ø—Ç–æ–º
          width: 500
        });
      }
    }];
  },

  // 2. –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–æ–∫ (–±–µ–π–¥–∂) –Ω–∞ —Ñ–∞—Å–∞–¥ –∫–∞—Ä—Ç–æ—á–∫–∏
  'card_facade_badges': async (context) => {
    // –ó–¥–µ—Å—å getCard() –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ parent_id
    const card = await context.getCard();
    
    // –ï—Å–ª–∏ —É –∫–∞—Ä—Ç–æ—á–∫–∏ –µ—Å—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–µ–ª–µ–Ω—ã–π –±–µ–π–¥–∂
    if (card.parent_id) {
      return {
        text: '‚úì –°–≤—è–∑–∞–Ω —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º',
        color: 'green'
      };
    }
    // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
    return null;
  }
});
